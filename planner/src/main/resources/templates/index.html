<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Insert title here</title>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <!-- For CSS -->
    <link rel="stylesheet" th:href="@{/css/swiper.css}"/>
    <link rel="stylesheet" th:href="@{/css/login.css}"/>
    <link rel="stylesheet" th:href="@{/css/header.css}"/>
    <link rel="stylesheet" th:href="@{/css/footer.css}"/>
</head>
<body>
<!-------------------------------- //header ----------------------------------------->
<div class="header">365-Day Schedule Management Program

    <div id="menuContainer">
        <img src="/img/mypage.png" id="clickableImage">

        <div class="menu" id="menu">
            <div class="menu-item"><a href="#">메뉴 1</a></div>
            <div class="menu-item"><a href="#">메뉴 2</a></div>
            <div class="menu-item"><a href="#">메뉴 3</a></div>
        </div>
    </div>
    <script>
        // 메뉴 클릭시 메뉴 토글
        document.getElementById("clickableImage").addEventListener("click", function() {
            var menu = document.getElementById("menu");
            menu.style.display = menu.style.display === "block" ? "none" : "block";
        });

        // 문서 클릭시 메뉴 숨김
        document.addEventListener("click", function(event) {
            var menu = document.getElementById("menu");
            var clickableImage = document.getElementById("clickableImage");
            var target = event.target;

            // 메뉴가 표시되어 있고, 클릭된 요소가 메뉴나 이미지가 아닌 경우 메뉴 숨김
            if (menu.style.display === "block" && target !== menu && target !== clickableImage) {
                menu.style.display = "none";
            }
        });
    </script>

</div>
<!-------------------------------- header// ------------------------------------------->


<div class="entire" id="loginForm">
    <form>
        <img src="img/logo.png" alt="logo" id="logo" width="50%"></a>
        <div class="sign-in">
            <div class="sign-box">
                <label for="email">Email</label>
                <input type="text" name="email" id="email" placeholder="Email@domain.com">
                <label for="password">Password</label>
                <input type="password" name="password" id="password" placeholder="Password">

                <div id="loginError" style="color: red;"></div>

                <div class="password-update-text">
                    <span>비밀번호를 왜 까먹는데 왜!!!!</span>
                    <a href="/web/passwordUpdate">찾으러 와라...</a>
                </div>
                <button>Login</button>
                <div class="sign-up-text">
                    <span>아직도 회원이 아니세요?</span>
                    <a href="/web/signup">지금 바로 시작!</a>
                </div>
            </div>
        </div>
        <div class="line">
            <p>or</p>
        </div>
        <div class="social-login">
            <a href="http://localhost:8080/oauth2/authorization/google?redirect_uri=http://localhost:8080&mode=login"><i><img src="img/google.png" alt="google login" id="google"></i></a>
            <a href="http://localhost:8080/oauth2/authorization/google?redirect_uri=http://localhost:8080&mode=unlink">
                <button type="button">Google Unlink</button>
            </a>
            <a href="http://localhost:8080/oauth2/authorization/naver?redirect_uri=http://localhost:8080&mode=login"><i><img src="img/naver.png" alt="naver login" id="naver"></i></a>
            <a href="http://localhost:8080/oauth2/authorization/naver?redirect_uri=http://localhost:8080&mode=unlink">
                <button type="button">Naver Unlink</button>
            </a>
            <a href="http://localhost:8080/oauth2/authorization/kakao?redirect_uri=http://localhost:8080&mode=login"><i><img src="img/kakao.png" alt="kakao login" id="kakao"></i></a>
            <a href="http://localhost:8080/oauth2/authorization/kakao?redirect_uri=http://localhost:8080&mode=unlink">
                <button type="button">Kakao Unlink</button>
            </a>
        </div>
    </form>
    <!-- Slider main container -->
    <div class="swiper">
        <!-- Additional required wrapper -->
        <div class="swiper-wrapper">
            <!-- Slides -->
            <!--            <img th:src="@{/img/month.png}" alt="Month Image">-->
            <!--            <img th:src="@{/img/week.png}" alt="Week Image">-->
            <!--            <img th:src="@{/img/day.png}" alt="Day Image">-->
            <div class="swiper-slide">
                <img src="img/month.png">
            </div>
            <div class="swiper-slide">
                <img src="img/week.png">
            </div>
            <div class="swiper-slide">
                <img src="img/day.png">
            </div>
        </div>
    </div>
</div>
<script>
    function loginErrorMassage(){
        var email = $('#email').val();
        var password = $('#password').val();
        var loginError = document.getElementById('loginError');
        loginError.style.fontWeight = 'bold';
        loginError.style.fontSize = '12px';
        if(email === "" || password === ""){
            loginError.textContent = "❌ 이메일 또는 비밀번호를 입력해주세요.";
            return false;
        }else{
            loginError.textContent = "";
            return true;
        }
    }
     $(document).ready(function() {
         var loginError = document.getElementById('loginError');
        $('#loginForm').on('submit', function(e) {
            e.preventDefault(); // 폼 기본 제출 방지

            if (!loginErrorMassage()) {
                return;
            }
            var loginData = {
                email: $('#email').val(),
                password: $('#password').val()
            };

            $.ajax({
                url: '/api/user/login',
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify(loginData),
                success: function(response) {
                    console.log(loginData);
                    window.location.href = '/web/main';
                    // if (response.success) {
                    //     window.location.href = '/main'; // 메인 페이지로 리다이렉트
                    // } else {
                    //     // 로그인 실패 처리
                    //     alert('로그인 실패');
                    // }
                },
                error: function(xhr,textStatus,error) {
                    if (xhr.status === 401) {
                        loginError.textContent = "❌이메일 또는 비밀번호가 일치하지 않습니다.";
                    } else {
                        loginError.textContent = "❌오류로 인하여 로그인에 실패하였습니다 다시 시도해주세요.";
                    }
                }
            });
        });
    });
</script>
<!-- For JavaScript 자바스크립트 div 마치고 적용됨-->
<script th:src="@{/js/main.js}"></script>

<!-------------------------------- // footer ----------------------------------------->
<footer class="footer">
    <div class="footer-content">
        <div class="footer-section">
            <h3>One Planner</h3>
            <p>Software Development Team</p>
            <p>Seoul Geumcheon-gu Gasan-dong Newty Castle</p>
            <p>Email: contact@oneplanner.com</p>
            <p>Phone: (123) 456-7890</p>
        </div>
        <div class="footer-section">
            <h3>Quick Links</h3>
            <ul>
                <li><a href="#">About Us</a></li>
                <li><a href="#">Our Services</a></li>
                <li><a href="#">Portfolio</a></li>
                <li><a href="#">Contact Us</a></li>
            </ul>
        </div>
        <div class="footer-section">
            <h3>Follow Us</h3>
            <a href="https://facebook.com/techinnovations">Facebook</a> |
            <a href="https://twitter.com/techinnovations">Twitter</a> |
            <a href="https://instagram.com/techinnovations">Instagram</a>
        </div>
        <div class="footer-section">
            <h3>Newsletter</h3>
            <p>Subscribe to our newsletter for the latest updates.</p>
            <form action="subscribe" method="post">
                <input type="email" name="email" placeholder="Enter your email">
                <button type="submit">Subscribe</button>
            </form>
        </div>
    </div>
    <div class="footer-bottom">
        <p>Copyright &copy; 2024 One Planner Technology. All rights reserved.</p>
    </div>
</footer>
<!-------------------------------- footer // ------------------------------------------->

</body>
</html>